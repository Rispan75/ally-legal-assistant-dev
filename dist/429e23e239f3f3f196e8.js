/*! For license information please see 429e23e239f3f3f196e8.js.LICENSE.txt */
function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,c=Object.create(a.prototype),i=new I(r||[]);return o(c,"_invoke",{value:T(e,n,i)}),c}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",f="suspendedYield",h="executing",y="completed",m={};function v(){}function g(){}function x(){}var E={};l(E,c,(function(){return this}));var C=Object.getPrototypeOf,b=C&&C(C(P([])));b&&b!==n&&r.call(b,c)&&(E=b);var L=x.prototype=v.prototype=Object.create(E);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(o,a,c,i){var s=d(e[o],e,a);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==_typeof(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,c,i)}),(function(e){n("throw",e,c,i)})):t.resolve(u).then((function(e){l.value=e,c(l)}),(function(e){return n("throw",e,c,i)}))}i(s.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function T(t,n,r){var o=p;return function(a,c){if(o===h)throw Error("Generator is already running");if(o===y){if("throw"===a)throw c;return{value:e,done:!0}}for(r.method=a,r.arg=c;;){var i=r.delegate;if(i){var s=S(i,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=h;var l=d(t,n,r);if("normal"===l.type){if(o=r.done?y:f,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function S(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var a=d(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var c=a.arg;return c?c.done?(n[t.resultName]=c.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[c];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(_typeof(t)+" is not iterable")}return g.prototype=x,o(L,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:g,configurable:!0}),g.displayName=l(x,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l(e,s,"GeneratorFunction")),e.prototype=Object.create(L),e},t.awrap=function(e){return{__await:e}},w(_.prototype),l(_.prototype,i,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var c=new _(u(e,n,r,o),a);return t.isGeneratorFunction(n)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},w(L),l(L,s,"Generator"),l(L,c,(function(){return this})),l(L,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return i.type="throw",i.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var c=this.tryEntries[a],i=c.completion;if("root"===c.tryLoc)return o("end");if(c.tryLoc<=this.prev){var s=r.call(c,"catchLoc"),l=r.call(c,"finallyLoc");if(s&&l){if(this.prev<c.catchLoc)return o(c.catchLoc,!0);if(this.prev<c.finallyLoc)return o(c.finallyLoc)}else if(s){if(this.prev<c.catchLoc)return o(c.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return o(c.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var c=a?a.completion:{};return c.type=e,c.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}function asyncGeneratorStep(e,t,n,r,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){asyncGeneratorStep(a,r,o,c,i,"next",e)}function i(e){asyncGeneratorStep(a,r,o,c,i,"throw",e)}c(void 0)}))}}var storedSelectedText="",selectedOoxml="";export function summary(){return _summary.apply(this,arguments)}function _summary(){return _summary=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,r,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("policy-container"),n=localStorage.getItem("pfendpoint"),r=localStorage.getItem("language"),console.log("Summary function called with next parms: ",n,r),t&&(t.innerHTML=""),(o=document.createElement("div")).id="policy-spinner",o.classList.add("spinner"),o.style.display="block",t.appendChild(o),e.abrupt("return",Word.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var a,c,i,s,l,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(a=t.document.getSelection()).load("text, paragraphs/items"),e.next=5,t.sync();case 5:return c=a.paragraphs.items,console.log("Paragraphs:",c),i="",c.forEach((function(e){e.load("text,")})),e.next=11,t.sync();case 11:for(s=[],l=0;l<c.length;l++)""!==c[l]._Te&&" "!==c[l]._Te&&"  "!==c[l]._Te&&"   "!==c[l]._Te||s.push(l);for(u=s.length-1;u>=0;u--)c.splice(s[u],1);return e.next=16,t.sync();case 16:return c.forEach((function(e){e.load("listItem"),e.load("text")})),e.next=19,t.sync();case 19:if(c.forEach((function(e){var t=e.listItem?e.listItem.listString:"",n=e.text;i+=t+n+"\n"})),a.text){e.next=24;break}displayNoTextSelectedMessage(),e.next=27;break;case 24:return console.log("test"),e.next=27,processSelectedText(i,n,r);case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(0),console.error("Error: "+e.t0),o&&(o.style.display="none");case 33:case"end":return e.stop()}}),e,null,[[0,29]])})));return function(t){return e.apply(this,arguments)}}()));case 11:case"end":return e.stop()}}),e)}))),_summary.apply(this,arguments)}function displayNoTextSelectedMessage(){var e=document.getElementById("policy-container");e&&(e.innerHTML=""),console.log("No text selected");var t=document.createElement("h2");t.classList.add("policy-title"),t.textContent="Review & Mark-up";var n=document.createElement("div");n.classList.add("warning"),n.textContent="I'm sorry, you didn't select any text. Please select a text and try again.",e.appendChild(t),e.appendChild(n),e.appendChild(document.createElement("p")),e.appendChild(document.createElement("hr"));var r=document.createElement("button");r.classList.add("search-button"),r.textContent="Review",r.addEventListener("click",summary),e.appendChild(r)}function processSelectedText(e,t,n){return _processSelectedText.apply(this,arguments)}function _processSelectedText(){return(_processSelectedText=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var o,a,c;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return storedSelectedText=t.substring(0,150),saveSelectedText(),o=JSON.parse(localStorage.getItem("groups")),e.next=5,fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query_type:2,question:t,group:o,language:r})});case 5:return a=e.sent,e.next=8,a.json();case 8:(c=e.sent).answer.warning?displayWarningMessage():displayPolicyItems(c.answer.PolicyItems);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function displayWarningMessage(){var e=document.getElementById("policy-container");e&&(e.innerHTML="");var t=document.createElement("h2");t.classList.add("policy-title"),t.textContent="Review & Mark-up",e.appendChild(t);var n=document.createElement("div");n.classList.add("warning"),n.textContent="I'm sorry, I couldn't find any policy items in your company for the selected text.",e.appendChild(n);var r=document.createElement("div");r.classList.add("warning"),r.textContent="Please review the possible causes below and try again.",e.appendChild(r);var o=document.createElement("table");o.classList.add("causes-table"),["Cause 1: No matching policy found.","Cause 2: Text may be too vague.","Cause 3: System error."].forEach((function(e){var t=document.createElement("tr"),n=document.createElement("td");n.innerHTML="<strong>".concat(e.split(":")[0],"</strong>: ").concat(e.split(":")[1]),t.appendChild(n),o.appendChild(t)})),e.appendChild(o),e.appendChild(document.createElement("hr"));var a=document.createElement("button");a.classList.add("search-button"),a.textContent="Review Next",a.addEventListener("click",summary),e.appendChild(a)}function displayPolicyItems(e){var t=document.getElementById("policy-container");t&&(t.innerHTML=""),e.forEach((function(e,n){var r=createPolicyDiv(e,n);t.appendChild(r)}));var n=document.createElement("button");n.classList.add("search-button"),n.textContent="Review Next",n.addEventListener("click",summary),t.appendChild(n)}function createPolicyDiv(e,t){var n=document.createElement("div");n.classList.add("policy-container");var r=document.createElement("div");r.classList.add("policy-header"),r.style.cursor="pointer",r.addEventListener("click",(function(){return toggleContent(t)}));var o=document.createElement("div");o.classList.add("compliance-icon"),o.classList.add("yes"===e.iscompliant?"compliant":"non-compliant");var a=document.createElement("span");a.classList.add("policy-title"),a.textContent=e.title;var c=document.createElement("span");c.classList.add("toggle-marker"),c.textContent="▼",r.appendChild(o),r.appendChild(a),r.appendChild(c),n.appendChild(r);var i=document.createElement("div");return i.classList.add("policy-content"),i.id="policy-content-".concat(t),i.style.display="none",addPolicyDetails(i,e,t),n.appendChild(i),n}function addPolicyDetails(e,t,n){var r=[{label:"Summary",value:t.summary},{label:"Relevant Company Policy Item",value:t.relevant_policy_item}];"yes"!==t.iscompliant&&(r.push({label:"Suggested Correction",value:t.suggested_correction}),r.push({label:"Suggestion based on company knowledge base",value:""})),t.key_phrases&&t.key_phrases.length>0&&r.push({label:"Key Phrases",value:t.key_phrases.join(", ")}),r.forEach((function(t){var n=document.createElement("div");n.classList.add("policy-field");var r=document.createElement("div");r.classList.add("field-title"),r.textContent="".concat(t.label,":");var o=document.createElement("div");o.textContent=t.value,n.appendChild(r),n.appendChild(o),e.appendChild(n)})),"yes"!==t.iscompliant&&addCarousel(e,t.corrected_text)}function addCarousel(e,t){var n=0,r=document.createElement("div");r.classList.add("carousel-container");var o=document.createElement("div");o.classList.add("carousel-text"),o.textContent=t[n];var a=document.createElement("div");a.classList.add("variation-number"),a.textContent="".concat(n+1,"/").concat(t.length);var c=document.createElement("button");c.classList.add("carousel-button","carousel-left"),c.textContent="◀",c.addEventListener("click",(function(){n>0&&(n--,updateCarousel(o,a,t,n))}));var i=document.createElement("button");i.classList.add("carousel-button","carousel-right"),i.textContent="▶",i.addEventListener("click",(function(){n<t.length-1&&(n++,updateCarousel(o,a,t,n))})),r.appendChild(c),r.appendChild(o),r.appendChild(i),r.appendChild(a),e.appendChild(r),addCarouselButtons(e,t[n])}function updateCarousel(e,t,n,r){e.textContent=n[r],t.textContent="".concat(r+1,"/").concat(n.length)}function addCarouselButtons(e,t){var n=document.createElement("div");n.classList.add("button-container");var r=document.createElement("button");r.textContent="Mark-up",r.classList.add("search-button"),r.addEventListener("click",(function(){return fixText(t)})),e.appendChild(r),e.appendChild(document.createElement("p"));var o=document.createElement("button");o.textContent="Go To",o.classList.add("search-button"),o.addEventListener("click",(function(){return gotoText(t)})),e.appendChild(o),e.appendChild(n)}function fixText(e){Word.run(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(n){var r;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=n.document.getSelection()).load("text"),t.next=4,n.sync();case 4:return r.insertText(e,Word.InsertLocation.replace),t.next=7,n.sync();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e)}))}function gotoText(){Word.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.document.body.search(storedSelectedText,{matchCase:!1}),t.load(n,"text"),e.next=4,t.sync();case 4:if(!(n.items.length>0)){e.next=11;break}return n.items[0].select(),e.next=8,t.sync();case 8:console.log("Navigated to the text: ",storedSelectedText),e.next=12;break;case 11:console.log("Text not found.");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e)}))}function toggleContent(e){var t=document.getElementById("policy-content-".concat(e));t.style.display="none"===t.style.display?"block":"none"}function insertCorrectedText(e){Office.context.document.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Ooxml},(function(t){t.status===Office.AsyncResultStatus.Succeeded?(console.log("Corrected OOXML inserted successfully."),console.log("Corrected OOXML: ",e)):console.log("Error: "+t.error.message)}))}function saveSelectedText(){Office.context.document.getSelectedDataAsync(Office.CoercionType.Ooxml,(function(e){e.status===Office.AsyncResultStatus.Succeeded?selectedOoxml=e.value:console.log("Error: "+e.error.message)}))}