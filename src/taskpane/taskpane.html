<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>GBB Leagal Add-in</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    
    <script type="module" src="Containers/aks.js"></script>  
    <script type="module" src="Containers/summary_selected.js"></script>
    <script type="module" src="Containers/summary_document.js"></script>

    <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/>

    <!-- Template styles -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />
    
    <style>    
    </style>
</head>

<body class="ms-font-m ms-welcome ms-Fabric">

    <div class="warning-ribbon" style="display: none;">
        <span id="ribbon-text"></span>
      </div>
    
    <section id="sideload-msg" class="ms-welcome__main" style="display: none;">
        <div class="spinner"></div><h1 style="text-align: center;">Checking AI configuration, please wait...</h1>
    </section>
        
    <main id="app-body" class="ms-welcome__main" style="display: none;">
        <!-- title with icon icon.png on the left and h1 titile on the right side -->
        <div class="flex-container"  >
            <div style="align-content: center;"><img src="../../assets/icon-80.ico" alt="GBB" title="GBB"/></div>
            <div><h1 class="ms-font-xxl ms-fontWeight-semilight">Ally Legal</h1></div>
        </div>
        <h2 id="title-with-name" class="ms-font-xl"> Discover the many ways Azure OpenAI Service can help you draft and review your contracts more efficiently.</h2>
        <ul class="ms-List ms-welcome__features">
            <li class="ms-ListItem">
                <i class="ms-Icon ms-Icon--Ribbon ms-font-xl"></i>
                <span class="ms-font-m">Draft using your organizational knowledge</span>
            </li>
            <li class="ms-ListItem">
                <i class="ms-Icon ms-Icon--Unlock ms-font-xl"></i>
                <span class="ms-font-m">Unlock new insights from your contracts to drive informed decisions</span>
            </li>
            <li class="ms-ListItem">
                <i class="ms-Icon ms-Icon--Design ms-font-xl"></i>
                <span class="ms-font-m">Expedite your contract review process by chatting with your data in real-time</span>
            </li>
        </ul>
        <p class="ms-font-l">Select from the next <b>3</b> options.</p>



        <div id="demo-container" class="container">
            <h2>Demo Functions</h2>         
             <p>Select the language for the answers</p>
            <select id="language-select" class="search-input">
                <option value="English">English</option>
                <option value="Greek">Greek</option>
                <option value="Russian">Russian</option>
                <option value="Spanish">Spanish</option>
                <option value="German">German</option>
                <option value="French">French</option>
                <option value="Italian">Italian</option>
                <option value="Dutch">Dutch</option>
                <option value="Portuguese">Portuguese</option>
                <option value="Danish">Danish</option>
                <option value="Finnish">Finnish</option>
                <option value="Norwegian">Norwegian</option>
                <option value="Polish">Polish</option>
                <opeion value="Czech">Czech</option>
                <option value="Russian">Russian</option>
                <option value="Swedish">Swedish</option>
                <option value="Turkish">Turkish</option>
            </select>

            <p>Clear the cache to start fresh</p>
            <button class="ms-Button ms-Button--primary search-button" id="reset-button">
                <span class="ms-Button-label">Clear Cache</span>
            </button>

        </div>
        <br>

        <!--- Create a button to index the current document -->
        <!--  I need to have a script running in the background to index the document and when it is done, I will show a message that the document is indexed and ready for search and review. -->
        <div class="container" id="index-doc-container" style="display: none; background-color: #ffe5e5; border: 1px solid #ff9999; border-radius: 8px; padding: 16px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
            <h2 style="color: #b30000; margin-top: 0;">⚠️ Document Not Ready</h2>
            <p style="color: #5c0000; font-size: 15px;">
                Your document hasn't been prepared yet. Please press the <b>Index Now</b> button to use all the AI features.
            </p>
            <b id="filename-notindexed-label" style="display: none;"></b>
            <div id="index-doc-spinner" style="display: none;" class="spinner"></div>
            <button class="ms-Button ms-Button--primary search-button" id="index-doc-button" style="margin-top: 12px; background-color:#003049; border: none;">
                <span class="ms-Button-label">Index Now</span>
            </button>
        </div>
        
        <br>

        <div id="summary-container" class="container">
            <h2>Summary</h2>
            <p>Summarize the document to get a quick overview of the key clauses and provisions</p>
            <div id="summary-spinner" style="display: none;" class="spinner"></div>
            <button class="ms-Button ms-Button--primary search-button" id="fetchSummaryData">
                <span class="ms-Button-label">Summarize Document</span>
            </button>
            <div id="summary-content"></div> <!-- This will hold the dynamic content -->
        </div>
        
        <br>

        <!--- Ask Button -->
        <div class="container" id="ask-container">
            <h2>Ask a Question</h2>
            <p>Chat with your contract to uncover the general meaning of the various provisions</p>
            <div id="ask-spinner" style="display: none;" class="spinner"></div>
            <input type="text" class="search-input" id="ask-input" name="search" placeholder="Write your question">
            <button class="ms-Button ms-Button--primary search-button" id="ask-button">
                <span class="ms-Button-label">Ask on the contract</span>
            </button>
        </div>
        
        <br>



        <div id="policy-container" class="container">
            <h2>Review & Mark-up</h2>
            <p>Make a risk assessment of key contract clauses compared to your organizational standard. </p>
            <p>This button will review the document based on organizational standard</p>
            <p>and will suggest mark-up for the clause.</p>
            <div id="policy-spinner" style="display: none;" class="spinner"></div>
            <button class="ms-Button ms-Button--primary search-button" id="fetchPolicyData">
            <span class="ms-Button-label">Check Policies</span>
            </button>   
        </div>

        
        <div class="container" id="iteration-container">  
            <h2>Unused Policies</h2>
            <p>Click the button to analyze and process document clauses for any unused policies.</p>
            <div id="iteration-spinner" style="display: none;" class="spinner"></div>
            <button class="ms-Button ms-Button--primary search-button" id="iteration-button">
                <span class="ms-Button-label">Run Iteration</span>
            </button>
        </div>

        
        <br>
    </main>
</body>

</html>
<!-- <script type="text/javascript">
    var ButtonElements = document.querySelectorAll(".ms-Button");
  </script> -->
